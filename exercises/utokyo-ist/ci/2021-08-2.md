# 創造情報学 第2問

計算問題に加えて、幾何分布およびTCPウインドウ制御の理解が問われる問題。

通信速度の解析については[IoT通信性能解析](https://amzn.to/3Af1fpZ)が試験の範囲を越えて非常に詳しい。

## (1)

パケットの転送開始からACKの到着までの転送時間は次の通り。最初のACKが到着するまでの時間なので、ボトルネックの存在は考慮していない。

$$
\begin{align}
(\frac{1}{10^4} + D_2 + \frac{1}{10^4}) * 2 + (\frac{1}{10^9} + \frac{1}{B_2}+ \frac{1}{10^9}) * (m_1+m_2)
\end{align}
$$

また、確率は次の通り。

$$
\begin{align}
a^{n-1} (1-a)
\end{align}
$$

## (2)

### 平均転送速度

あえて平均転送速度と最大転送速度を分けて書いているので、文脈的にビット誤りを考慮してほしいものと推察する。ビット誤りのないデータ転送にかかる回数の期待値を求める。これは、成功か失敗かの試行（ベルヌーイ試行）が初めて成功するまでの確率分布（幾何分布）である。よって、期待値は次の通り。

$$
\begin{align}
E &= \frac{1}{1-a} \\
\end{align}
$$

片道の平均転送速度を求める。まず転送時間を求め、次にパケットサイズを転送時間で割る。

$$
\begin{align}
(1-a) * \frac{m_1}{\frac{2}{10^4} + D_2 + \frac{m_1}{10^9}} \text{ bits/sec}, && \text{if } B_2 \ge B_1 = B_3 \\
(1-a) * \frac{m_1}{\frac{2}{10^4} + D_2 + \frac{m_1}{B_2}} \text{ bits/sec}, && \text{else if } B_2 < B_1 = B_3
\end{align}
$$

### 最大転送速度

与えられた数値に基づいて計算を行う。問題文に最大の転送速度とあることから、ビット誤りは無視する（$a=0$）。また、$m_1=m_2=100$とあることから、往復の最大転送速度を求める。

$D_2=0.1\text{msec}, B_2=1\text{Gbits/sec}$の場合、片道の最大転送速度は次の通り。

$$
\begin{align}
& \frac{100}{\frac{2}{10^4} + \frac{1}{10^4} + \frac{100}{10^9}}\\
=& \frac{100}{\frac{3}{10^4} + \frac{100}{10^9}} \\
=& \frac{100}{\frac{3001}{10^7}} \\
=& \frac{10^9}{3001} \\
\approx& \frac{10^6}{3} \\
\approx& 0.333 \text{ Mbits/sec} \\
\end{align}
$$

よって、往復の最大転送速度は約 $0.167 \text{Mbits/sec}$ となる。

$D_2=500\text{msec}, B_2=10\text{Mbits/sec}$の場合、片道の最大転送速度は次の通り。

$$
\begin{align}
& \frac{100}{\frac{2}{10^4} + \frac{5}{10} + \frac{100}{10^7}} \\
=& \frac{100}{\frac{2}{10^4} + \frac{5}{10} + \frac{1}{10^5}} \\
=& \frac{100}{\frac{50021}{10^5}} \\
=& \frac{100 * 10^5}{50001} \\
=& \frac{10^7}{50001} \\
\approx& \frac{10^3}{5} \\
\approx& 0.2 * 10^3 \\
\approx& 0.2\text{ Kbits/sec} \\
\end{align}
$$

よって、往復の最大転送速度は約 $0.1 \text{ Kbits/sec}$ となる。

## (3)

ウィンドウサイズの上限まではACKを待たずにパケットを送信できる。つまり、往復あたりのACKを待つ必要がある回数の期待値はパケットサイズ/ウインドウサイズ $= \frac{m_1}{64*8*10^3}$となる。したがって、1往復あたりの送信+受信回数の期待値は次の通り。

$$
\begin{align}
& 1 + \frac{100}{64*8*10^3} = \frac{5121}{5120}
\end{align}
$$

$m_1 = m_2 = 100$ で往復のパケットサイズが等しいので、往復の最大転送速度は片道の最大転送速度に送受信回数の期待値の逆数をかければ良い。

$D_2=0.1\text{msec}, B_2=1\text{Gbits/sec}$の場合は次の通り。

$$
\begin{align}
& \frac{10^9}{3001} * \frac{5120}{5121} \\
\approx& 0.333\text{ Mbits/sec} \\
\end{align}
$$

$D_2=500\text{msec}, B_2=10\text{Mbits/sec}$の場合は次の通り。

$$
\begin{align}
& \frac{10^7}{50001} * \frac{5120}{5121} \\
\approx& 0.2\text{ Kbits/sec}
\end{align}
$$

## (4)

サーバ $n$ にファイルをアップロードする際、ACKパケットが到着するまでの平均時間を $t_n\text{ sec}$とする。ビット誤りが発生する確率$a$が与えられていると考えると、最大転送速度は平均速度に転送成功までの回数の期待値の逆数をかけた値となる。

$$
\begin{align}
& t_n * (\frac{1}{1-a})^{-1} = t_n (1-a)
\end{align}
$$

## (5)

ここまでの問題から、転送速度に対しては遅延が支配的であることが分かるため、帯域および復路は無視する。

$$
\begin{align}
\frac{100}{D_{2\text{max}}} &= 8 * 10^6 \\
D_{2\text{max}} &= \frac{100}{8 * 10^6} \\
D_{2\text{max}} &= \frac{12.5}{10^6} \\
D_{2\text{max}} &= 0.0125\text{ msec}\\
\end{align}
$$

## (6)

1. オリジンとなるサーバーとは別に、地理的に近いデータセンターにCDNを置く。
2. クライアントノード間で動画ストリーミング再生ファイルを共有する（P2P）。
