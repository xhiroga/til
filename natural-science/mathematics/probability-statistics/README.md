# 確率, 統計 (probability and statistics)

## 期待値, 分散, 標準偏差 (expected value, variance, and standard deviation)

- 期待値
- 分散
- 標準偏差
  - $\sigma$（シグマ）を用いるのは、SpreadのSからではないか、とChatGPTは言っていた（要検証）
- 偏差
  - 平均や中央など、基準値との差のこと。特に基準を示さない場合は平均との差だと思って良さそうだ。
- Mean Absolute Deviation, MAD（平均絶対偏差）
  - 偏差（平均との差）の絶対値の平均。分散のように2乗しないため、一見便利そうに見える。
  - しかし、微分不可能なため、実は最適化や解析で扱いが難しいことがある...らしい。
- 共分散
  - 多次元確率変数、つまり複数のパラメータがあるデータを想定する。例えばクラスの国語と数学のテストの得点など。
  - データごとに各パラメータの偏差の積を取り、データ全体でその平均を出す。
  - 平均が10倍なら共分散も10倍になる。このように、元データの単位に依存して数字が変わる指標を、スケール依存性があるという。
- 相関
  - 共分散からスケール依存性を取り除いた指標。
  - 共分散を偏差の積で割って求める。

> [!NOTE] 標準偏差の計算では、分散の分母$N$まで含めて平方根を取る。にも関わらず、母数が過小評価されないのはなぜか？
> 標準偏差は$N$の平方根を取るにも関わらず、母数が過小評価されない、つまりデータ数が増えるほど標準偏差が増えることはありません。
> 標準偏差の代わりに、分散の分子だけを平方根で括った指標で不都合があることを、次の通り証明します。
> ![formula](https://i.gyazo.com/thumb/3024/568e1dc7cfddb4ce0a1a6eff369f940d-heic.jpg)

### 演算の公式

期待値・分散の世界にも、微分積分の世界における合成関数のような概念があり、変数変換と呼ぶ。

- 期待値・分散・標準偏差: 省略
- 期待値の演算の線形性
  - $E[X+Y] = E[X] + E[Y]$
  - $E[XY] = E[X] * E[Y]$
- 変数変換された確率の期待値・分散
  - $Y = aX+b$として、
  - $E[Y] = aE[X]+b$
  - $V[Y] = a^2V[X]$

<!-- なぜ分散のbは無視して良い？ -->

## ベイズの定理 (bayes' theorem)

ベイズの定理における用語は次の通り。

![ベイズの定理](https://i.gyazo.com/thumb/1635/7109ff2f8edfcbb2b28ee88a44c759c5-heic.jpg)

また、[ベイズの定理を面積と計算グラフで表す](https://hiroga.hatenablog.com/entry/2024/05/07/111028)も参照。

> [!NOTE] 仮説を選ぶ際、事後分布を使う必要はある？同時確率で十分では？
> 確かに、事後分布は同時確率の比を百分率で表したに過ぎないから、同時確率を使って仮説を選んでもいい。
> ただし、同時確率はデータの珍しさに影響されてしまう。珍しいデータの時も、そうでない時も、一貫した意思決定をするためには、事後分布に基準を設けるのがよいだろう。

## k次のモーメント・モーメント母関数, 積率母関数 (moments and moment generating functions)

確率分布の性質を知るためには、期待値や分散、歪度、尖度が役に立つ。これらを導出するためには、確率変数$X$の$k$乗の期待値が便利である。
これを$k$次のモーメントと呼ぶ。

また、それらを体系的に扱うためのツールとしてモーメント母関数がある。モーメント母関数をマクローリン展開するとモーメントが得られ、期待値や分散の算出に役立つ。（マクローリン展開ってグラフなどを書きづらい関数を近似して雑ながらも書こう、という気持ちで理解していたから、すでに完成している関数を部品取りのためにマクローリン展開するのってなんか背徳感あるな...）

## 確率分布

| 性質          | 離散型確率分布における定義 | 連続型確率分布における定義 |
| ------------- | -------------------------- |
| 確率関数[^pf] | 確率質量関数               | 確率密度関数               |
| 分布関数[^df] |                            |

確率質量関数のグラフを描いた際、Y軸はその事象が発生する確率であり、1を超えることはない。一方、確率密度関数におけるY軸の値は1を超えることがある。連続型確率分布において特定の事象が発生する確率を求めることはできないので、ある区間に数値が収まる確率を求めることになる。したがって、確率密度関数においてY軸が1を超えていたら、「面積の合計は1になるはずだから、分散が小さいのかもしれないなぁ」位に思っておけば良い。

[^pf]: 確率関数という言葉が何を指すかは曖昧である。マセマに準じれば、単に確率関数と言った場合は確率質量関数を指す。
[^df]: 単に分布関数といえば、累積分布関数を指す。

### 離散型確率分布 (discrete probability distribution)

#### ベルヌーイ試行, ベルヌーイ分布

成功か失敗かの事象を0か1で表した試行をベルヌーイ試行といい、その確率分布をベルヌーイ分布と呼ぶ。

#### 二項分布, 二項定理 (binomial distribution, binomial theorem)

$(a+b)^3$のような2項の累乗を、次の式で表せることを二項定理という。

$(a+b)^n = \sum_{k=0}^n \binom{n}{k}a^{n-k}{b^k}$

（ここで$\binom{n}{k}$とは${}_nC_k$を指す。計算方法は、「n通り、n-1通り、...から1つ選ぶをk回繰り返し、重複を避けるためk!通りで割る」なので、$\frac{\prod_{i=0}^{k-1}(n-i)}{k!}$である）

それ自体は中学校の数学で習うのだが、この式はそのまま、「成功か失敗かのいずれかの結果になる事象をn回行い、k回成功する確率」を求めるために利用できる。

ベルヌーイ分布, 二項分布の期待値, 分散の導出は次の通り。

![ベルヌーイ分布, 二項分布の期待値, 分散の導出](https://i.gyazo.com/thumb/2306/dca4ddec4e49108543cdca0d271b86c1-heic.jpg)

#### 幾何分布 (geometric distribution)

ベルヌーイ試行が初めて成功するまでに何回かかるかの確率分布を幾何分布という。

![幾何分布の導出](https://i.gyazo.com/05ea5817edd55ed79517c1a4d81e6e43.jpg)

#### 負の二項分布 (negative binomial distribution)

ベルヌーイ試行がn回成功するまでの過程の確率の分布。失敗回数を指す場合と、合計の試行回数を指す場合とがある。

合計の試行回数を指す場合、それぞれの試行が独立なので、幾何分布の期待値と分散をn倍すると期待値と分散が求められる。

### 連続型確率分布 (continuous probability distribution)

- [ガンマ関数(2D) 🔐](https://www.desmos.com/calculator/av8pojjzxt?lang=ja)
- [ガンマ関数(3D) 🔐](https://www.desmos.com/3D/03sdf3jqz9?lang=ja)

### 運用

- カルバック・ライブラー・ダイバージェンス: WIP
- AIC
<!-- http://www.radio3.ee.uec.ac.jp/ronbun/TR_YK_048_AIC.pdf -->

## 未分類 (uncategorized)

- サロゲートデータ法: WIP
- 共分散分析 (ANCOVA): WIP
- 中心極限定理: WIP
- ベイジアンネットワーク: WIP
- 不偏推定量: WIP
- 共役: WIP
