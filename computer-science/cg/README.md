# CG (Computer Graphics)

## 基礎知識

> [!NOTE] ビットマップ画像とラスタ画像って同じ？
> 同じ意味で使われるが、厳密には異なる。ラスターはラテン語で引っ掻くを意味する rodere に由来し、同じ語源を持つ言葉としては rake (熊手) や rodent (げっ歯類) がある。
> 画像を平行な線の集合と捉えてスキャンすることをラスタースキャンという。FAXの送受信はラスタースキャンを用いている。そのように表現された画像をラスタ画像と呼ぶ。
> ビットマップ画像はラスター画像をコンピューターで扱うための仕様といえる。元々は、フォントを画面上に表示する際のビットの割当表をビットマップと呼んだそうだ。

## 座標変換とパイプライン

### 3次元座標系

X,Y,Zの3軸を考えたとき、Z軸を奥から手前向きに、Y軸を下から上向きに固定した際、X軸が右向き（右手系）か左向き（左手系）かの違い。または、X軸を右向きに固定した際、Y軸が上向き（右手系）か下向き（左手系）かの違い。言い換えると、座標(0,0)が左下（右手系）か左下（左手系）かの違い。

学校の数学では座標(0,0)が左下なのに対して、テレビでは座標(0,0)が左上だったことが違いを生んでいると言われている。[^stackoverflow_2011]
[^stackoverflow_2011]: [Historic reasons for Left-Handed Coordinate System](https://stackoverflow.com/questions/6698817/historic-reasons-for-left-handed-coordinate-system)

### シェーダー

2000年前後、グラフィックボードの進化に伴いCPUの処理がボトルネックとなり、オブジェクトの座標変換と照明 (Transform&Lightning)もグラフィックボードが担当するようになった。Direct7では予め用意されたシェーダーを利用するのみだったが、Direct8からはプログラミング可能なシェーダーが登場し、現在ではこれを単にシェーダーと呼ぶ。

## モデリング

## レンダリング

### フォトリアリスティックレンダリング

### 隠面消去

3Dオブジェクトを描画する際、手前の面だけが見えるようにすること。凸面だけのオブジェクト単体を考えるなら、こちらを向いている面だけを描画すればよい。具体的には、法線と視点のベクトルの内積を取り、その値が正なら描画する。

奥のオブジェクトから順番に描画し、重なった箇所は手前のオブジェクトで塗りつぶすアルゴリズムを優先順位アルゴリズム、またはペインタアルゴリズムと呼ぶ。予めオブジェクトを奥行き順にソートする必要がある。オブジェクトが3すくみの場合には、オブジェクト単位で優先順位を付けることができないため、ポリゴンを2つに切断する。ペインタアルゴリズムは見えないオブジェクトまで描画するため効率が悪い。したがって、手前から順に描画する逆ペインタアルゴリズムも存在する。

スクリーンを1行ごとに描画する手法として、スキャンライン法がある。[^try3dcg_render]オブジェクトの重なり合いの判定を1行毎に行うため、アルゴリズムはやや複雑であり、かつ時間がかかる。しかし、1行毎にディスプレイに反映してしまって構わないため、メモリの少ない環境でも採用できる。[^oshita_2019]
[^try3dcg_render]: [【はじめての3DCG】：スキャンライン](https://www.asahi-net.or.jp/~qb3k-kwsk/3dcg/know/render/render11.html)
[^oshita_2019]: [コンピューターグラフィックスＳ](http://www.ha.ai.kyutech.ac.jp/lecture/cg/cg05_rendering_s.pdf)

ペインタアルゴリズムはポリゴンの分割やオブジェクトのソートが必須であり、アルゴリズムがやや複雑となり、おそらく並列計算との相性も悪い。そこで、全てのオブジェクトのピクセルについて、そのピクセルが暫定的に最も手前であった場合にバッファの色を更新するようなアルゴリズムがあり、これをZバッファ法と呼ぶ。GPUのサポートがあることから、広く利用されている。

スキャンライン法では、オブジェクトの重なり合いの判定を行の区間ごとに行った。ピクセル単位で行うのがレイトレーシング法である。

### 隠線消去

### シェーディング

### 影付け（シャドウイング）

### マッピング


## アニメーション

## References

[コンピュータグラフィックス](https://amzn.to/3xirgU8)
