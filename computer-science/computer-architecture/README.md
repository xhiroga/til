# コンピュータアーキテクチャ・OS・デジタル回路

## 数体系・符号体系

### n進数の小数部

![n進数の小数部](/images/n進数の小数部.svg)

### Radix Conversion （基数変換）

n進数→10進数は次のように考える。4,000（よんせん）は40 00（よんじゅう ひゃく）と考えることができる。同様に、0.05 = 5厘（ごりん）は0.5分（れいてんごぶ）とも考えられる。このように、指数の絶対値が大きい桁の数字による数は、指数の絶対値が小さい桁の数字でも表せる。n進数→10進数の変換では、$n^{|m|}$の倍数を$n^{|m-1|}$の倍数で表す操作を繰り返す。

また、10進数→n進数は次のように考える。指数の絶対値が小さい桁の数は、指数の絶対値が大きい桁の数としては表すことができない。（ここで4は0.4 10と言い出すとややこしいので一旦考えない）そのため、nで割って/掛けて、余り/整数部を指数の絶対値が小さい桁の数にする。

<!-- ちょっと説明がこなれていないが、時間の関係でここまでとする。 -->

最後に、n進数・10進数間の変換について表と図にまとめた。

| 変換\部分    | 整数部                                                       | 小数部                                                       |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| n進数→10進数 | 大きい桁から順に、nを掛けて1つ小さい桁の値と足す、を繰り返す | 小さい桁から順に、nで割って1つ大きい桁の値と足す、を繰り返す |
| 10進数→n進数 | nで割って余りを取り出し、下位桁に並べるのを繰り返す          | nを掛けて整数部を取り出し、上位桁に並べるのを繰り返す        |

![n進数](/images/n進数.svg)

### Complement （補数）

足すと基数になるものが補数である。例えば、876の10の補数(1000の補数とは言わない)は124である。

要するに1000からその数を引けば求められるのだが、代わりに999から引いて1を足して求めると繰り下がりがなくて計算しやすい。各桁の9の補数を求めて、その値を連結して1を足すとも言える。

同様に、16の補数、2の補数などn進数の補数が存在する。2の補数を求めるためには、各桁の1の補数を求めて、その結果を連結して1を足すことになる。つまり全桁を反転させてから1を足すのに等しい。この全桁を反転させた値も1の補数と呼ぶが、それ以外の補数の定義とは違って紛らわしいのでやめたほうがいいと思う。

## 論理演算

<!-- ドントケア項は二重に括ったほうがお得 -->

<!-- アクティブ状態とインアクティブ状態と、LowとHighの区別がつかない -->

### MIL記法

米軍の物資調達のために開発された米軍ミル企画の一つである、[MIL-STD-806](https://bitsavers.org/pdf/mil-std/MIL-STD-806B_Graphical_Symbols_For_Logic_Diagrams_19620226.pdf)に基づいた論理回路の記法。

<!-- 状態◯がNotを指すのがよく分からない -->

## Combinational logical circuit （組み合わせ回路）

<!-- 書き方について -->

### 加減算器

<!-- 半加算器 -->

### エンコーダ・デコーダ

### マルチプレクサ・デマルチプレクサ

## フリップフロップ

デジタル回路で入力を保持したい場合、回路にループを作ればよい。

入力を後から取り出せる回路を広義のフリップフロップという。値を入力すると状態が変わるように見えるため、フリップフロップという名前といわれている。[^renesas_flipflop]
[^renesas_flipflop]: [順序回路、フリップフロップ](https://www.renesas.com/jp/ja/support/engineer-school/digital-circuits-03-sequential-logic)

しかし、単に回路をループさせると、一度の（厳密には、同一のクロックパルス内で）入力で出力が何度も変わってしまう。そこでクロック毎に一度だけ値が変わるようにしたのが、狭義のフリップフロップである。そうでないものは非同期式フリップフロップ、またはラッチと呼ぶ。

フリップフロップの種類について、次の通りまとめる。

- 入力による分類
  - SR:
  - D:
  - JK: JKフリップフロップ。ICの開発者であるJack Kilby（ジャック・キルビー）に由来するとする説もあるが、証拠はない。[^why-called-jk-flip-flop] SRフリップフロップの改良版で、入力が(1,1)のときに出力が反転する。
  - T: Toggle（トグル）フリップフロップ。

[^why-called-jk-flip-flop]: [Why called JK flip-flop?](https://www.edaboard.com/threads/why-called-jk-flip-flop.25589/)

> [!NOTE]
なぜSRラッチにSet/Resetが必要なのかを自分なりに考えたが、入力が1つでは保持した値の取り出し・0のセット・1のセット、という3種類のコマンドを表現できないためという結論になった。High/Lowに加えてNullがある世界なら入力が1つのSRラッチが存在するかもしれない。  
また、現実世界でフリップフロップに相当するものがないかを考えた。電流のように流れ続けるが、初期の入力を保ち続けるものがないだろうか。水泳のインターバルトレーニング（サイクル）が相当するなと思った。25mを40秒サイクルで回るとき、1~40, 81~120, ...秒目にいる方が、スタートしたプールサイドである。

- 同期の仕組みによる分類
  - ラッチ（非同期式）
  - フリップフロップ（同期式）
  - マスタスレーブ型: FFを2つ連結させ、クロックが1のとき1つ目に、0のとき2つ目に書き込む
  - エッジトリガ型: マスタスレーブ型ではクロックの立ち上がりから立ち下がりまで入力を継続する必要がある点を改良した。SRラッチを組体操のように3つ重ねた構成。立ち上がり時に書き込んで以降はロックアウトされる仕組み。

<!-- TODO: エッジトリガ型よく分かっていない -->

フリップフロップの分類を、次の通り表にした。

| 入力 | ラッチ | フリップフロップ | マスタスレーブ | エッジトリガ |
| ---- | ------ | ---------------- | -------------- | ------------ |
| SR   | ◯      | ◯                | ◯              | ◯            |
| D    | ◯      | ◯                | ◯              | ◯            |
| JK   | -      | -                | ◯              | ◯            |
| T    | -      | -                | ◯              | ◯            |

## 順序回路

<!-- 特性方程式と論理式、特性表と真理値表の関係 -->

## 論理回路

## メモリ

## コンピュータ

## References

- [論理回路入門 | 坂井修一](https://amzn.to/4aLvj99)
- [論理回路入門 | 浜辺隆二](https://amzn.to/4bL7Y8L)
